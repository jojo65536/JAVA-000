# 学习笔记

## 类加载器
### 类的生命周期
- 加载：Class文件，
- 链接
    - 验证
    - 准备
    - 解析
- 初始化
- 使用
- 卸载
### 双亲委派
- 原理：先查找父加载器
- 好处：共享，兄弟加载器之间独立
- 应用：热加载
## 内存结构
- 堆
- 线程栈
- 非堆
- 堆外内存
## 内存模型
- JMM规范定义了可见性等相关问题
- Happens-Before原则
## 启动参数
- -D 系统属性
- 堆内存相关
    - -Xmx 堆最大内存
    - -Xms 堆初始内存大小
    - -Xmn 建议-Xmx的1/2-1/4 新生代大小
    - -XX: MaxMetaspaceSize Meta空间，Java8一般不设置
    - -Xss **每个**线程栈的大小
- GC相关
    - +UseXXXX
## 命令行工具
- jps -mlv 查看java进程, 有进程号、启动参数等信息
- jstat 可以查看各种统计信息，-gcutil -gc 
- jmap
    - -heap 堆内存配置和使用信息
    - -histo 统计各种类的大小和实例个数，方便排查问题
    - -dump
- jstack 可能需要系统root权限，可以看到检测到的死锁
    - -F 强制dump
    - -m 混合模式，Java帧和native帧
    - -l 长列表
- jcmd
    - VM.info
## GC一般原理
### 识别
- 引用计数
- 可达性分析
    - GCRoots
### 收集方法
- 标记清除
- 移动
- 复制
## 几种GC算法
- 串行
- 并行Parallel GC
    - 增大吞吐量，减少暂停时间
- CMS GC
    - 避免卡顿
    - 不对老年代整理
- G1 GC
    - 棋盘式内存布局
    - 可设置最大暂停时间
    - 可设置触发阈值

